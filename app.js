var board = {
    canvas: null,
    tiles: [],
    ctx: null,
    visitedCells: [],
    size: 75,
    init: function () {
        this.canvas = document.getElementById('canvas');
        this.ctx = this.canvas.getContext('2d');
        this.drawBoard();
    },
    drawBoard: function () {
        for (var i = 0; i < 10; i++) {
            this.tiles[i] = [];
            for (var j = 0; j < 10; j++) {
                this.tiles[i].push(this.createCellObj(i, j));
                this.drawCell(j * this.size, i * this.size, this.tiles[i][j]);
            }
        }
        this.generateMaze(0, 0);
    },
    redrawBoard: function () {
        console.log(" redraw");
        this.clearBoard();
        for (var i = 0; i < 10; i++) {
            for (var j = 0; j < 10; j++) {
                console.log(this.tiles[i][j]);
                this.drawCell(j * this.size, i * this.size, this.tiles[i][j]);
            }
        }
    },
    generateMaze: function (row, col) {
        var currentCell = this.tiles[row][col];
        if (!currentCell.visited) {
            currentCell.visited = true;
            this.visitedCells.push(currentCell);
        }
        if (this.visitedCells.length === 0) {
            this.redrawBoard();
            return;
        }
        var neighborCell = this.findNeighbor(row, col);
        if (neighborCell !== undefined) {
            if (neighborCell.row > currentCell.row) {
                neighborCell.top = false;
                currentCell.bottom = false;
            }
            if (neighborCell.row < currentCell.row) {
                currentCell.top = false;
                neighborCell.bottom = false;
            }
            if (neighborCell.col > currentCell.col) {
                currentCell.right = false;
                neighborCell.left = false;
            }
            if (neighborCell.col < currentCell.col) {
                currentCell.left = false;
                neighborCell.right = false;
            }
            currentCell = neighborCell;
        }
        else {
            currentCell = this.visitedCells.pop();
        }
        this.generateMaze(currentCell.row, currentCell.col);
    },
    findNeighbor: function (row, col) {
        var neighborArray = [];
        var selectedCell;
        if (row >= 0 && col > 0) {
            selectedCell = this.tiles[row][col - 1];
            if (!selectedCell.visited) {
                neighborArray.push(selectedCell);
            }
        }
        if (row >= 0 && col < 9) {
            selectedCell = this.tiles[row][col + 1];
            if (!selectedCell.visited) {
                neighborArray.push(selectedCell);
            }
        }
        if (row > 0 && col >= 0) {
            selectedCell = this.tiles[row - 1][col];
            if (!selectedCell.visited) {
                neighborArray.push(selectedCell);
            }
        }
        if (row < 9 && col >= 0) {
            selectedCell = this.tiles[row + 1][col];
            if (!selectedCell.visited) {
                neighborArray.push(selectedCell);
            }
        }
        if (neighborArray.length > 0) {
            var randNum = Math.floor(Math.random() * neighborArray.length);
            return neighborArray[randNum];
        }
        else {
            return undefined;
        }
    },
    drawCell: function (x, y, tile) {
        var side = this.size;
        this.ctx.beginPath();
        if (tile.left) {
            this.drawLine(x, y, x, y + side);
        }
        if (tile.right) {
            this.drawLine(x + side, y, x + side, y + side);
        }
        if (tile.top) {
            this.drawLine(x, y, x + side, y);
        }
        if (tile.bottom) {
            this.drawLine(x, y + side, x + side, y + side);
        }
        this.ctx.stroke();
    },
    drawLine: function (x, y, endX, endY) {
        this.ctx.moveTo(x, y);
        this.ctx.lineTo(endX, endY);
    },
    createCellObj: function (row, col) {
        var obj = {
            row: row,
            col: col,
            visited: false,
            left: true,
            right: true,
            top: true,
            bottom: true
        };
        return obj;
    },
    clearBoard: function () {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
};
board.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLElBQUksS0FBSyxHQUFHO0lBQ1YsTUFBTSxFQUFHLElBQUk7SUFDYixLQUFLLEVBQUcsRUFBRTtJQUNWLEdBQUcsRUFBQyxJQUFJO0lBQ1IsWUFBWSxFQUFFLEVBQUU7SUFDaEIsSUFBSSxFQUFFLEVBQUU7SUFDUixJQUFJLEVBQUc7UUFDTCxJQUFJLENBQUMsTUFBTSxHQUFzQixRQUFRLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ25FLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDeEMsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ25CLENBQUM7SUFDRCxTQUFTLEVBQUU7UUFFVCxHQUFHLENBQUEsQ0FBQyxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUMsQ0FBQyxHQUFDLEVBQUUsRUFBQyxDQUFDLEVBQUUsRUFBQyxDQUFDO1lBQ3BCLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ25CLEdBQUcsQ0FBQSxDQUFDLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBQyxDQUFDLEdBQUMsRUFBRSxFQUFDLENBQUMsRUFBRSxFQUFDLENBQUM7Z0JBQ3BCLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzVDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzVELENBQUM7UUFDSCxDQUFD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QUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFBLENBQUM7WUFDYixJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNDLENBQUM7UUFFRCxFQUFFLENBQUEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUEsQ0FBQztZQUNYLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFDLENBQUMsRUFBQyxDQUFDLEdBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQy9CLENBQUM7UUFFRCxFQUFFLENBQUEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQztZQUNkLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFDLElBQUksRUFBRSxDQUFDLEdBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0MsQ0FBQztRQUVELElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDcEIsQ0FBQztJQUVELFFBQVEsRUFBQyxVQUFTLENBQUMsRUFBQyxDQUFDLEVBQUMsSUFBSSxFQUFFLElBQUk7UUFDOUIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JCLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBQ0QsYUFBYSxFQUFHLFVBQVMsR0FBRyxFQUFFLEdBQUc7UUFDL0IsSUFBSSxHQUFHLEdBQUc7WUFDUixHQUFHLEVBQUMsR0FBRztZQUNQLEdBQUcsRUFBQyxHQUFHO1lBQ1AsT0FBTyxFQUFDLEtBQUs7WUFDYixJQUFJLEVBQUMsSUFBSTtZQUNULEtBQUssRUFBQyxJQUFJO1lBQ1YsR0FBRyxFQUFDLElBQUk7WUFDUixNQUFNLEVBQUMsSUFBSTtTQUNaLENBQUM7UUFDRixNQUFNLENBQUMsR0FBRyxDQUFDO0lBQ2IsQ0FBQztJQUNELFVBQVUsRUFBRTtRQUNWLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNsRSxDQUFDO0NBQ0YsQ0FBQztBQUVGLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxubGV0IGJvYXJkID0ge1xyXG4gIGNhbnZhcyA6IG51bGwsXHJcbiAgdGlsZXMgOiBbXSxcclxuICBjdHg6bnVsbCxcclxuICB2aXNpdGVkQ2VsbHMgOltdLFxyXG4gIHNpemU6IDc1LFxyXG4gIGluaXQgOiBmdW5jdGlvbigpe1xyXG4gICAgdGhpcy5jYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpO1xyXG4gICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgdGhpcy5kcmF3Qm9hcmQoKTtcclxuICB9LFxyXG4gIGRyYXdCb2FyZDogZnVuY3Rpb24oKXtcclxuICAvLyAgbGV0IHNpZGUgPSA3NTtcclxuICAgIGZvcihsZXQgaT0wO2k8MTA7aSsrKXtcclxuICAgICAgdGhpcy50aWxlc1tpXSA9IFtdO1xyXG4gICAgICBmb3IobGV0IGo9MDtqPDEwO2orKyl7XHJcbiAgICAgICAgdGhpcy50aWxlc1tpXS5wdXNoKHRoaXMuY3JlYXRlQ2VsbE9iaihpLGopKTtcclxuICAgICAgICB0aGlzLmRyYXdDZWxsKGoqdGhpcy5zaXplLCBpKnRoaXMuc2l6ZSwgdGhpcy50aWxlc1tpXVtqXSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuZ2VuZXJhdGVNYXplKDAsMCk7XHJcbiAgfSxcclxuXHJcbiAgcmVkcmF3Qm9hcmQgOiBmdW5jdGlvbigpe1xyXG4gICAgY29uc29sZS5sb2coXCIgcmVkcmF3XCIpO1xyXG4gICAgdGhpcy5jbGVhckJvYXJkKCk7XHJcbiAgICBmb3IobGV0IGk9MDtpPDEwO2krKyl7XHJcbiAgICAgIGZvcihsZXQgaj0wO2o8MTA7aisrKXtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnRpbGVzW2ldW2pdKTtcclxuICAgICAgICB0aGlzLmRyYXdDZWxsKGoqdGhpcy5zaXplLCBpKnRoaXMuc2l6ZSwgdGhpcy50aWxlc1tpXVtqXSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfSxcclxuXHJcbiAgZ2VuZXJhdGVNYXplOiBmdW5jdGlvbihyb3csIGNvbCl7XHJcbiAgICBsZXQgY3VycmVudENlbGwgPSB0aGlzLnRpbGVzW3Jvd11bY29sXTtcclxuICAgIGlmKCFjdXJyZW50Q2VsbC52aXNpdGVkKXtcclxuICAgICAgY3VycmVudENlbGwudmlzaXRlZCA9IHRydWU7XHJcbiAgICAgIHRoaXMudmlzaXRlZENlbGxzLnB1c2goY3VycmVudENlbGwpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGFsbCB0aGUgY2VsbHMgaGF2ZSBiZWVuIHZpc2l0ZWQgYW5kIGNoZWNrZWRcclxuICAgIGlmKHRoaXMudmlzaXRlZENlbGxzLmxlbmd0aCA9PT0gMCl7XHJcbiAgICAgIHRoaXMucmVkcmF3Qm9hcmQoKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IG5laWdoYm9yQ2VsbCA9IHRoaXMuZmluZE5laWdoYm9yKHJvdywgY29sKTtcclxuICAgIGlmKG5laWdoYm9yQ2VsbCAhPT0gdW5kZWZpbmVkKXtcclxuICAgICAgLy9ib3R0b20gY2VsbFxyXG4gICAgICBpZihuZWlnaGJvckNlbGwucm93ID4gY3VycmVudENlbGwucm93KXtcclxuICAgICAgICBuZWlnaGJvckNlbGwudG9wID0gZmFsc2U7XHJcbiAgICAgICAgY3VycmVudENlbGwuYm90dG9tID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy90b3AgY2VsbFxyXG4gICAgICBpZihuZWlnaGJvckNlbGwucm93IDwgY3VycmVudENlbGwucm93KXtcclxuICAgICAgICBjdXJyZW50Q2VsbC50b3AgPSBmYWxzZTtcclxuICAgICAgICBuZWlnaGJvckNlbGwuYm90dG9tID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgLy9yaWdodCBjZWxsXHJcbiAgICAgIGlmKG5laWdoYm9yQ2VsbC5jb2wgPiBjdXJyZW50Q2VsbC5jb2wpe1xyXG4gICAgICAgIGN1cnJlbnRDZWxsLnJpZ2h0ID0gZmFsc2U7XHJcbiAgICAgICAgbmVpZ2hib3JDZWxsLmxlZnQgPSBmYWxzZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy9sZWZ0IGNlbGxcclxuICAgICAgaWYobmVpZ2hib3JDZWxsLmNvbCA8IGN1cnJlbnRDZWxsLmNvbCl7XHJcbiAgICAgICAgY3VycmVudENlbGwubGVmdCA9IGZhbHNlO1xyXG4gICAgICAgIG5laWdoYm9yQ2VsbC5yaWdodCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGN1cnJlbnRDZWxsID0gbmVpZ2hib3JDZWxsO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgIC8vIGlmIG5vIG5laWdoYm9ycyBhcmUgZm91bmQgZ28gYmFjayB0byB0aGUgcHJldmlvdXMgdmlzaXRlZCBjZWxsXHJcbiAgICAgIGN1cnJlbnRDZWxsID0gdGhpcy52aXNpdGVkQ2VsbHMucG9wKCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmdlbmVyYXRlTWF6ZShjdXJyZW50Q2VsbC5yb3csIGN1cnJlbnRDZWxsLmNvbCk7XHJcbiAgfSxcclxuXHJcbiAgZmluZE5laWdoYm9yIDogZnVuY3Rpb24ocm93LCBjb2wpe1xyXG4gICAgbGV0IG5laWdoYm9yQXJyYXkgPSBbXTtcclxuICAgIGxldCBzZWxlY3RlZENlbGw7XHJcblxyXG4gICAgLy8gY2hlY2tpbmcgZm9yIGxlZnQgY2VsbFxyXG4gICAgaWYocm93ID49IDAgJiYgY29sID4gMCl7XHJcbiAgICAgIHNlbGVjdGVkQ2VsbCA9IHRoaXMudGlsZXNbcm93XVtjb2wtMV07XHJcbiAgICAgIGlmKCFzZWxlY3RlZENlbGwudmlzaXRlZCl7XHJcbiAgICAgICAgbmVpZ2hib3JBcnJheS5wdXNoKHNlbGVjdGVkQ2VsbCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL2NoZWNraW5nIGZvciByaWdodCBjdXJyZW50Q2VsbFxyXG4gICAgaWYocm93ID49IDAgJiYgY29sIDwgOSl7XHJcbiAgICAgIHNlbGVjdGVkQ2VsbCA9IHRoaXMudGlsZXNbcm93XVtjb2wrMV07XHJcbiAgICAgIGlmKCFzZWxlY3RlZENlbGwudmlzaXRlZCl7XHJcbiAgICAgICAgbmVpZ2hib3JBcnJheS5wdXNoKHNlbGVjdGVkQ2VsbCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIC8vY2hlY2tpbmcgZm9yIHRoZSB0b3Agcm93XHJcbiAgICBpZihyb3cgPiAwICYmIGNvbCA+PSAwKXtcclxuICAgICAgc2VsZWN0ZWRDZWxsID0gdGhpcy50aWxlc1tyb3ctMV1bY29sXTtcclxuICAgICAgaWYoIXNlbGVjdGVkQ2VsbC52aXNpdGVkKXtcclxuICAgICAgICBuZWlnaGJvckFycmF5LnB1c2goc2VsZWN0ZWRDZWxsKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vY2hlY2tpbmcgZm9yIGJvdHRvbSByb3dcclxuICAgIGlmKHJvdyA8IDkgJiYgY29sPj0wKXtcclxuICAgICAgc2VsZWN0ZWRDZWxsID0gdGhpcy50aWxlc1tyb3crMV1bY29sXTtcclxuICAgICAgaWYoIXNlbGVjdGVkQ2VsbC52aXNpdGVkKXtcclxuICAgICAgICBuZWlnaGJvckFycmF5LnB1c2goc2VsZWN0ZWRDZWxsKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmKG5laWdoYm9yQXJyYXkubGVuZ3RoID4gMCl7XHJcbiAgICAgIC8vY2hvb3NlIGEgcmFuZG9tIG5laWdoYm9yXHJcbiAgICAgICAgdmFyIHJhbmROdW0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuZWlnaGJvckFycmF5Lmxlbmd0aCk7XHJcbiAgICAgICAgcmV0dXJuIG5laWdoYm9yQXJyYXlbcmFuZE51bV07XHJcbiAgICB9ZWxzZXtcclxuICAgICAgLy8gTm8gbmVpZ2hib3Igd2FzIGZvdW5kXHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgfSxcclxuXHJcbiAgZHJhd0NlbGw6IGZ1bmN0aW9uKHgsIHksIHRpbGUpe1xyXG4gICAgbGV0IHNpZGUgPSB0aGlzLnNpemU7XHJcbiAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgIGlmKHRpbGUubGVmdCl7XHJcbiAgICAgIHRoaXMuZHJhd0xpbmUoeCwgeSwgeCwgeStzaWRlKTtcclxuICAgIH1cclxuXHJcbiAgICBpZih0aWxlLnJpZ2h0KXtcclxuICAgICAgdGhpcy5kcmF3TGluZSh4K3NpZGUsIHksIHgrc2lkZSwgeStzaWRlKTtcclxuICAgIH1cclxuXHJcbiAgICBpZih0aWxlLnRvcCl7XHJcbiAgICAgIHRoaXMuZHJhd0xpbmUoeCx5LHgrc2lkZSwgeSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYodGlsZS5ib3R0b20pe1xyXG4gICAgICB0aGlzLmRyYXdMaW5lKHgsIHkrc2lkZSwgeCtzaWRlLCB5K3NpZGUpO1xyXG4gICAgfSAgICBcclxuXHJcbiAgICB0aGlzLmN0eC5zdHJva2UoKTtcclxuICB9LFxyXG5cclxuICBkcmF3TGluZTpmdW5jdGlvbih4LHksZW5kWCwgZW5kWSl7XHJcbiAgICB0aGlzLmN0eC5tb3ZlVG8oeCx5KTtcclxuICAgIHRoaXMuY3R4LmxpbmVUbyhlbmRYLCBlbmRZKTtcclxuICB9LFxyXG4gIGNyZWF0ZUNlbGxPYmogOiBmdW5jdGlvbihyb3csIGNvbCl7XHJcbiAgICBsZXQgb2JqID0ge1xyXG4gICAgICByb3c6cm93LFxyXG4gICAgICBjb2w6Y29sLFxyXG4gICAgICB2aXNpdGVkOmZhbHNlLFxyXG4gICAgICBsZWZ0OnRydWUsXHJcbiAgICAgIHJpZ2h0OnRydWUsXHJcbiAgICAgIHRvcDp0cnVlLFxyXG4gICAgICBib3R0b206dHJ1ZVxyXG4gICAgfTtcclxuICAgIHJldHVybiBvYmo7XHJcbiAgfSxcclxuICBjbGVhckJvYXJkOiBmdW5jdGlvbigpe1xyXG4gICAgdGhpcy5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG4gIH1cclxufTtcclxuXHJcbmJvYXJkLmluaXQoKTtcclxuIl19